<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–æ—Ä–∑–∏–Ω–∞ ‚Äî –§—Ä–æ–õ–µ–Ω –ï–ö–ë</title>
  <link rel="icon" type="image/x-icon" href="/frolen-website/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/frolen-website/favicon.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <div class="header-top">
    <img src="logo.webp" alt="–§—Ä–æ–õ–µ–Ω –ï–ö–ë" class="logo">
    <div class="branding">
      <h1>üåøüßº –§—Ä–æ–õ–µ–Ω –ï–ö–ë</h1>
      <p class="subtitle">–ù–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ –º—ã–ª–æ –∏ —Å–≤–µ—á–∏ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã</p>
    </div>
  </div>

  <nav class="main-nav">
    <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="mylo.html">–ú—ã–ª–æ</a>
    <a href="probniki.html">–ü—Ä–æ–±–Ω–∏–∫–∏</a>
    <a href="pod_zakaz.html">–ü–æ–¥ –∑–∞–∫–∞–∑</a>
    <a href="svechi.html">–°–≤–µ—á–∏</a>
    <a href="dostavka.html">–î–æ—Å—Ç–∞–≤–∫–∞</a>
     <a href="faq.html">–í–æ–ø—Ä–æ—Å—ã</a> 
    <a href="cart.html" class="active cart-link">üõí <span id="cart-count">0</span></a>
  </nav>
</header>

<div class="container cart-container">

  <h2 class="section-title">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>

  <div id="cart-content">
    <!-- –°—é–¥–∞ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã -->
  </div>

  <div id="cart-total" class="cart-total">
    –ò—Ç–æ–≥–æ: <span id="total-amount">0</span> ‚ÇΩ
  </div>

  <div class="cart-cta">
    <h3 style="text-align: center; margin-bottom: 1rem;">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</h3>
    <form id="order-form">
      <div class="form-group">
        <label for="customer-name">–í–∞—à–µ –∏–º—è:</label>
        <input type="text" id="customer-name" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –ê–Ω–Ω–∞">
        <div class="error" id="name-error"></div>
      </div>
      <div class="form-group">
        <label for="customer-phone">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏:</label>
        <input type="tel" id="customer-phone" required placeholder="+7 (999) 123-45-67">
        <div class="error" id="phone-error"></div>
      </div>
      <button type="submit" class="btn btn-orange">
        –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –≤ Telegram
      </button>
    </form>
    <p class="cart-hint">
      –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Telegram ‚Äî –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
    </p>
  </div>

</div>

<footer>
  <p>–•–æ—Ç–∏—Ç–µ –∑–∞–∫–∞–∑–∞—Ç—å –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏?</p>
  <a href="https://t.me/parentvoeimamy" class="btn" target="_blank">üì© –ù–∞–ø–∏—Å–∞—Ç—å –≤ Telegram</a>
  <p class="footer-note">
    –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥—É ‚Ä¢ –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π —Å–æ—Å—Ç–∞–≤ ‚Ä¢ –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞
  </p>
</footer>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
  (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
  m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
  (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  ym(104870619, "init", {
    clickmap: true,
    trackLinks: true,
    accurateTrackBounce: true,
    webvisor: true,
    trackHash: true
  });
</script>
<noscript>
  <div>
    <img src="https://mc.yandex.ru/watch/104870619" style="position:absolute; left:-9999px;" alt="" />
  </div>
</noscript>
<!-- /Yandex.Metrika counter -->

<!-- –°–∫—Ä–∏–ø—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–∫–∞–∑–∞ -->
<script>
  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º
  document.addEventListener('DOMContentLoaded', () => {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartContent = document.getElementById('cart-content');
    const totalAmountEl = document.getElementById('total-amount');
    const cartTotalEl = document.getElementById('cart-total');
    const cartCountEl = document.getElementById('cart-count');

    function updateCartDisplay() {
      const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
      if (cartCountEl) cartCountEl.textContent = totalCount;

      if (cart.length === 0) {
        cartContent.innerHTML = `
          <p class="cart-empty">
            –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üò¢<br>
            <a href="index.html" class="cart-empty-link">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
          </p>
        `;
        cartTotalEl.style.display = 'none';
      } else {
        let html = '';
        let total = 0;

        cart.forEach((item, index) => {
          const itemTotal = item.price * item.quantity;
          total += itemTotal;
          html += `
            <div class="cart-item">
              <img src="${item.image}" alt="${item.name}" class="cart-item-img">
              <div class="cart-item-info">
                <h3>${item.name}</h3>
                <p>${item.price} ‚ÇΩ √ó ${item.quantity}</p>
                <p class="cart-item-total">${itemTotal} ‚ÇΩ</p>
              </div>
              <div class="cart-item-controls">
                <button class="quantity-btn minus" data-index="${index}">‚Äì</button>
                <button class="quantity-btn plus" data-index="${index}">+</button>
              </div>
            </div>
          `;
        });

        cartContent.innerHTML = html;
        totalAmountEl.textContent = total;
        cartTotalEl.style.display = 'block';

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ +/- –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞
        addQuantityEventListeners();
      }
    }

    function addQuantityEventListeners() {
      document.querySelectorAll('.quantity-btn.minus').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.dataset.index);
          if (cart[index].quantity > 1) {
            cart[index].quantity -= 1;
          } else {
            cart.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ç–æ–≤–∞—Ä, –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = 1
          }
          localStorage.setItem('cart', JSON.stringify(cart));
          updateCartDisplay();
        });
      });

      document.querySelectorAll('.quantity-btn.plus').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.dataset.index);
          cart[index].quantity += 1;
          localStorage.setItem('cart', JSON.stringify(cart));
          updateCartDisplay();
        });
      });
    }

    updateCartDisplay();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞
    document.getElementById('order-form')?.addEventListener('submit', function(e) {
      e.preventDefault();

      document.querySelectorAll('.error').forEach(el => el.textContent = '');
      
      const name = document.getElementById('customer-name').value.trim();
      const phone = document.getElementById('customer-phone').value.trim();
      const cart = JSON.parse(localStorage.getItem('cart')) || [];

      let hasError = false;

      if (!name) {
        document.getElementById('name-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∏–º—è.';
        hasError = true;
      }

      const phoneRegex = /^(\+?7|8)?[\s\-]?\(?[489]\d{2}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}$/;
      if (!phone) {
        document.getElementById('phone-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω.';
        hasError = true;
      } else if (!phoneRegex.test(phone.replace(/\s+/g, ' '))) {
        document.getElementById('phone-error').textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, +7 912 345-67-89).';
        hasError = true;
      }

      if (cart.length === 0) {
        alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!');
        return;
      }

      if (hasError) return;

      let itemsText = '';
      let total = 0;
      cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        itemsText += `‚Ä¢ ${item.name} ‚Äî ${item.price} ‚ÇΩ √ó ${item.quantity}\n`;
      });

      const message = `üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑!\n\n–ò–º—è: ${name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n\n–¢–æ–≤–∞—Ä—ã:\n${itemsText}–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ`;
      const encodedMessage = encodeURIComponent(message);
      const telegramUrl = `https://t.me/parentvoeimamy?text=${encodedMessage}`;

      // üî• –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
      window.location.href = telegramUrl;

      // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
      localStorage.removeItem('cart');
      if (document.getElementById('cart-count')) {
        document.getElementById('cart-count').textContent = '0';
      }
      if (document.getElementById('cart-content')) {
        document.getElementById('cart-content').innerHTML = `
          <p class="cart-empty">
            –í–∞—à –∑–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –°–ø–∞—Å–∏–±–æ üåø<br>
            <a href="index.html" class="cart-empty-link">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
          </p>
        `;
      }
      if (document.getElementById('cart-total')) {
        document.getElementById('cart-total').style.display = 'none';
      }
    });
  });
</script>

<script src="cart.js"></script>
</body>
</html>
